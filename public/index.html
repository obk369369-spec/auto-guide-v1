<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>WIC 자동화 안내서 (1번 도구 전용 v1.3)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <script defer src="app.js"></script>
  </head>
  <body>
    <header class="page-header">
      <h1>☀ WIC 자동화 안내서 (1번 도구 전용 v1.3)</h1>
      <p class="subtitle">
        이 화면은 <strong>1번 도구(자동화 안내서)</strong>만을 위한 전용 화면입니다.<br />
        <strong>고객데이터 → 분석 → 안내서 생성 → 후속조치</strong> 흐름을 한 번에 처리합니다.
      </p>

      <!-- 워드 템플릿 다운로드 -->
      <div class="download-area">
        <a
          href="/자동화안내서_v1.1.dotx"
          class="download-button"
          download="자동화안내서_v1.1.dotx"
        >
          자동화 안내서 Word 템플릿 다운로드
        </a>
        <p class="download-help">
          위 버튼으로 잠금 설정이 끝난
          <strong>자동화안내서_v1.1.dotx</strong>를 내려받아
          고객 안내서 기본 틀로 사용합니다.
        </p>
      </div>
    </header>

    <main class="layout">
      <!-- 왼쪽: 1·2단계 (고객데이터 + 분석) -->
      <section class="panel">
        <h2>1단계. 고객 데이터 불러오기</h2>
        <p class="panel-help">
          아직 고객 정리가 완벽하지 않아도, 장부 파일을 선택하고<br />
          “고객 데이터 불러오기” 버튼만 눌러도 준비 상태가 기록됩니다.
        </p>

        <div class="field">
          <label for="customer-file">고객 엑셀 파일 선택</label>
          <input id="customer-file" type="file" accept=".xlsx,.xls,.csv" />
        </div>

        <button id="load-customers" class="primary-button">
          고객 데이터 불러오기
        </button>

        <div class="field small-note">
          ※ 브라우저에서 .xls/.xlsx 내용을 직접 분석하려면
          나중에 별도 라이브러리(xlsx 등)를 불러와 연결하면 됩니다.
          지금은 “어떤 파일을 썼는지”와 분석 기준 메모 위주로 기록합니다.
        </div>

        <hr />

        <h2>2단계. 고객 데이터 분석 요약</h2>
        <p class="panel-help">
          여기에는 “어떤 고객을 우선 대상으로 삼을지” 기준을 적어 둡니다.<br />
          예: 연구비 있는 고객 / 최근 문의 고객 / 특정 연구분야(접착제, 글래스 기판 등)
        </p>

        <textarea
          id="analysis-output"
          class="report-output"
          placeholder="예: KITECH·KRICT 등 국책연은 연구비 O로 분류, 최근 1년 내 문의 + 관심분야=접착제/반도체/전자소재 위주 우선."
        ></textarea>
      </section>

      <!-- 오른쪽: 3·4단계 (안내서 생성 + 후속조치) -->
      <section class="panel">
        <h2>3단계. 안내서 초안 자동 생성</h2>
        <p class="panel-help">
          아래 버튼을 누르면 기본 안내서 텍스트 초안을 만듭니다.<br />
          내용을 복사해서 워드 템플릿(자동화안내서_v1.1.dotx)에 붙여 넣어 쓰면 됩니다.
        </p>

        <button id="generate-guide" class="primary-button">
          안내서 초안 생성
        </button>

        <div class="log-area">
          <h3>자동 생성 안내서 (복사해서 사용)</h3>
          <textarea
            id="report-output"
            class="report-output"
            placeholder="여기에 고객 안내서 초안이 생성됩니다."
          ></textarea>
        </div>

        <hr />

        <h2>4단계. 고객 반응 · 후속조치 기록</h2>
        <p class="panel-help">
          전화 / 추가자료 메일 / 무응답 등 고객 반응과 후속조치를<br />
          간단히 기록해 두면 나중에 장부·엑셀로 옮기기 쉬워집니다.
        </p>

        <div class="field">
          <label for="reaction-select">고객 반응</label>
          <select id="reaction-select">
            <option value="">선택하세요</option>
            <option value="opened">안내서 열어봄</option>
            <option value="replied">메일/전화 회신</option>
            <option value="no-response">무응답</option>
            <option value="request-quote">견적/입찰 요청</option>
          </select>
        </div>

        <div class="field">
          <label for="followup-notes">후속조치 메모</label>
          <textarea
            id="followup-notes"
            class="report-output"
            rows="4"
            placeholder="예: ○○박사 – 전화 통화, 추가자료 PDF 전송, 다음 주 재통화 예정."
          ></textarea>
        </div>

        <button id="save-followup" class="secondary-button">
          후속조치 기록
        </button>

        <div class="log-area">
          <h3>실행 로그</h3>
          <pre id="log-output" class="log-output">
(아직 실행 내역이 없습니다.)</pre
          >
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <p>
        ※ 이 화면은 1번 도구 전용입니다. 다른 도구(입찰, 연구비 엑셀 생성기 등)는
        각자 독립 대화창에서 따로 관리합니다.
      </p>
    </footer>
  </body>
</html>
